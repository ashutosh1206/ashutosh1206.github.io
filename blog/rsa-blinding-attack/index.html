<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Blinding Attack on RSA Signatures | Ash&#39;s blog</title>
<meta name="keywords" content="Blinding-Attack">
<meta name="description" content="This blog primarily focuses on Blinding Attack- an elementary vulnerability in unpadded RSA digital signature algorithm that can be exploited to forge signatures. The working and properties of Digital Signatures will be described before directly jumping onto the attack. In the end, we discuss ways to prevent this attack.
Unpadded Digital Signatures using RSA RSA is a kind of Trapdoor One-way Function. Wikipedia describes a one-way function as a function that is easy to compute on every input, but hard to invert given the image of a random input.">
<meta name="author" content="Ashutosh Ahelleya">
<link rel="canonical" href="https://ashutosh1206.github.io/blog/rsa-blinding-attack/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.bccfefac377bc340f06c260aed1bddf49a4354816d7c570d6aac75a997986c95.css" integrity="sha256-vM/vrDd7w0DwbCYK7Rvd9JpDVIFtfFcNaqx1qZeYbJU=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://ashutosh1206.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://ashutosh1206.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://ashutosh1206.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://ashutosh1206.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://ashutosh1206.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js" integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>
<meta property="og:title" content="Blinding Attack on RSA Signatures" />
<meta property="og:description" content="This blog primarily focuses on Blinding Attack- an elementary vulnerability in unpadded RSA digital signature algorithm that can be exploited to forge signatures. The working and properties of Digital Signatures will be described before directly jumping onto the attack. In the end, we discuss ways to prevent this attack.
Unpadded Digital Signatures using RSA RSA is a kind of Trapdoor One-way Function. Wikipedia describes a one-way function as a function that is easy to compute on every input, but hard to invert given the image of a random input." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ashutosh1206.github.io/blog/rsa-blinding-attack/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2017-07-10T00:00:00+00:00" />
<meta property="article:modified_time" content="2017-07-10T00:00:00+00:00" /><meta property="og:site_name" content="Ash&#39;s blog" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Blinding Attack on RSA Signatures"/>
<meta name="twitter:description" content="This blog primarily focuses on Blinding Attack- an elementary vulnerability in unpadded RSA digital signature algorithm that can be exploited to forge signatures. The working and properties of Digital Signatures will be described before directly jumping onto the attack. In the end, we discuss ways to prevent this attack.
Unpadded Digital Signatures using RSA RSA is a kind of Trapdoor One-way Function. Wikipedia describes a one-way function as a function that is easy to compute on every input, but hard to invert given the image of a random input."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Blogs",
      "item": "https://ashutosh1206.github.io/blog/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Blinding Attack on RSA Signatures",
      "item": "https://ashutosh1206.github.io/blog/rsa-blinding-attack/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Blinding Attack on RSA Signatures",
  "name": "Blinding Attack on RSA Signatures",
  "description": "This blog primarily focuses on Blinding Attack- an elementary vulnerability in unpadded RSA digital signature algorithm that can be exploited to forge signatures. The working and properties of Digital Signatures will be described before directly jumping onto the attack. In the end, we discuss ways to prevent this attack.\nUnpadded Digital Signatures using RSA RSA is a kind of Trapdoor One-way Function. Wikipedia describes a one-way function as a function that is easy to compute on every input, but hard to invert given the image of a random input.",
  "keywords": [
    "Blinding-Attack"
  ],
  "articleBody": "This blog primarily focuses on Blinding Attack- an elementary vulnerability in unpadded RSA digital signature algorithm that can be exploited to forge signatures. The working and properties of Digital Signatures will be described before directly jumping onto the attack. In the end, we discuss ways to prevent this attack.\nUnpadded Digital Signatures using RSA RSA is a kind of Trapdoor One-way Function. Wikipedia describes a one-way function as a function that is easy to compute on every input, but hard to invert given the image of a random input. Here, “easy” and “hard” are to be understood in the sense of computational complexity theory, specifically the theory of polynomial time problems.\nA trapdoor one-way function can only be inverted with the help of a trapdoor i.e. our \\(d\\), the private key in public key cryptosystems.\nLet \\(N\\) be the public modulus, \\(e\\) be the public key exponent and \\(d\\) be the private key exponent.\nThe relation between the three is as follows: $$ed\\equiv 1\\mod \\phi(n)$$\nLet Alice and Bob be two generic parties wishing to communicate with each other and Marvin be the eavesdropper, trying to tamper the data transfer between the two parties.\nThe scenario here is as follows: Alice is trying to get Bob’s signature on a message \\(M \\in Z^*_N\\). To get a signature, Alice sends the message \\(M\\) where Bob signs the message \\(M\\) as follows: $$S\\equiv M^d\\mod N$$\nHere, \\(S\\) is the signature of the message \\(M\\).\nIn the above step, Bob applies his private key to the message and obtains a signature \\(S\\). Bob then sends this \\(S\\) to Alice or any other authentic party which needs the signature of Bob on \\(M\\). Since public key of Bob, as the name suggests, is known to the parties, the signature can be easily verified if it is generated from Bob or not by simply calculating: $$S^e\\equiv M\\mod N$$\nOnly Bob has his private key and so the parties can conclude that the signature is authenticate and legible. In the next section, we will discuss some vulnerabilities in the above algorithm.\nBlinding Attack Consider the same scenario here, except for the fact that this time Marvin wants the Bob’s signature on a message \\(M\\) which Bob refuses. So instead of the signature on \\(M\\), Marvin asks for Bob’s signature on “innocent looking” \\(M’\\) which he calculates as following: $$M’ = r^eM\\mod N$$\nHere \\(r\\) in the above equation is any arbitrary positive integer in the same interval as \\(M\\).\nBob agrees to sign this message \\(M’\\). Let \\(S’\\) be the signature generated in case of \\(M’\\). We can write \\(S’\\) as: $$S’\\equiv (M’)^d\\mod N$$\nUpon receiving the signature of this message \\(M’\\), signature of message \\(M\\) can be easily forged by computing: \\(S\\equiv S’r^{-1}\\mod N\\)\nWhy does the above equation hold true? Let us see how:\n$$S’ \\equiv (M’)^d\\mod N$$ $$S’ \\equiv (r^eM)^d\\mod N$$ $$S’ \\equiv rM^d\\mod N$$\nMultiplying both sides of the above equation with \\(r^{-1}\\mod N\\) $$S’r^{-1}\\equiv rM^dr^{-1}\\mod N$$ $$S’r^{-1}\\equiv M^d\\mod N$$ $$S\\equiv S’r^{-1}\\mod N$$\nSo without actually getting the signature on \\(M\\), Marvin could successfully manipulate the signature \\(S’\\) to gain the signature of \\(M\\) i.e. \\(S\\). This technique allows an attacker to get signature on a message of his choice without the consent of the one who is signing it.\nPreventing Blinding Attack The question which arises now is, what could be the possible measures to prevent such attacks?\nIf the signatory signs the Hash of the message \\(M\\) instead of signing the message itself, all the four steps in the attack would make no sense since \\(M’\\) would then be replaced by H(M’) (The hash function) and hence it cannot be divided by blinding factor to get back \\(M\\).\nAnother advantage of using hash of the message instead of using the message is that a cryptographic hash can take an arbitrarily long message, and literally ‘compress’ it into a short string, in such a way that we cannot find two messages that hash to the same value. Hence, signing the hash is just as good as signing the original message, without the length restrictions we would have if we didn’t use a hash. This overcomes the size problem in RSA operation where the key has to be very large in order to sign smaller messages!\nReferences Twenty years of Attacks on RSA: https://crypto.stanford.edu/~dabo/papers/RSA-survey.pdf ",
  "wordCount" : "722",
  "inLanguage": "en",
  "datePublished": "2017-07-10T00:00:00Z",
  "dateModified": "2017-07-10T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Ashutosh Ahelleya"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://ashutosh1206.github.io/blog/rsa-blinding-attack/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Ash's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://ashutosh1206.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://ashutosh1206.github.io/" accesskey="h" title="Home (Alt + H)">Home</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://ashutosh1206.github.io/blog/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://ashutosh1206.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://ashutosh1206.github.io/archive/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://ashutosh1206.github.io/ctf/" title="CTF">
                    <span>CTF</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Blinding Attack on RSA Signatures
    </h1>
    <div class="post-meta"><span title='2017-07-10 00:00:00 +0000 UTC'>July 10, 2017</span>&nbsp;·&nbsp;Ashutosh Ahelleya

</div>
  </header> 
  <div class="post-content"><p>This blog primarily focuses on Blinding Attack- an elementary vulnerability in unpadded RSA digital signature algorithm that can be exploited to forge signatures. The working and properties of Digital Signatures will be described before directly jumping onto the attack. In the end, we discuss ways to prevent this attack.</p>
<h2 id="unpadded-digital-signatures-using-rsa">Unpadded Digital Signatures using RSA<a hidden class="anchor" aria-hidden="true" href="#unpadded-digital-signatures-using-rsa">#</a></h2>
<p>RSA is a kind of <strong>Trapdoor One-way Function</strong>. Wikipedia describes a one-way function as a function that is easy to compute on every input, but hard to invert given the image of a random input. Here, “easy” and “hard” are to be understood in the sense of computational complexity theory, specifically the theory of polynomial time problems.</p>
<p>A trapdoor one-way function can only be inverted with the help of a <strong>trapdoor</strong> i.e. our \(d\), the private key in <a href="https://en.wikipedia.org/wiki/Public-key_cryptography">public key cryptosystems</a>.</p>
<p>Let \(N\) be the public modulus, \(e\) be the public key exponent and \(d\) be the private key exponent.</p>
<p>The relation between the three is as follows:
$$ed\equiv 1\mod \phi(n)$$</p>
<p>Let Alice and Bob be two generic parties wishing to communicate with each other and Marvin be the eavesdropper, trying to tamper the data transfer between the two parties.</p>
<p>The scenario here is as follows: Alice is trying to get Bob&rsquo;s signature on a message \(M \in Z^*_N\). To get a signature, Alice sends the message \(M\) where Bob signs the message \(M\) as follows:
$$S\equiv M^d\mod N$$</p>
<p>Here, \(S\) is the signature of the message \(M\).</p>
<p>In the above step, Bob applies his private key to the message and obtains a signature \(S\). Bob then sends this \(S\) to Alice or any other authentic party which needs the signature of Bob on \(M\). Since public key of Bob, as the name suggests, is known to the parties, the signature can be easily verified if it is generated from Bob or not by simply calculating:
$$S^e\equiv M\mod N$$</p>
<p>Only Bob has his private key and so the parties can conclude that the signature is authenticate and legible. In the next section, we will discuss some vulnerabilities in the above algorithm.</p>
<h2 id="blinding-attack">Blinding Attack<a hidden class="anchor" aria-hidden="true" href="#blinding-attack">#</a></h2>
<p>Consider the same scenario here, except for the fact that this time Marvin wants the Bob&rsquo;s signature on a message \(M\) which Bob refuses. So instead of the signature on \(M\), Marvin asks for Bob&rsquo;s signature on “innocent looking” \(M’\) which he calculates as following:
$$M&rsquo; = r^eM\mod N$$</p>
<p>Here \(r\) in the above equation is any arbitrary positive integer in the same interval as \(M\).</p>
<p>Bob agrees to sign this message \(M’\). Let \(S’\) be the signature generated in case of \(M’\). We can write \(S’\) as:
$$S&rsquo;\equiv (M&rsquo;)^d\mod N$$</p>
<p>Upon receiving the signature of this message \(M&rsquo;\), signature of message \(M\) can be easily forged by computing: \(S\equiv S&rsquo;r^{-1}\mod N\)</p>
<p>Why does the above equation hold true? Let us see how:<br>
$$S&rsquo; \equiv (M&rsquo;)^d\mod N$$
$$S&rsquo; \equiv (r^eM)^d\mod N$$
$$S&rsquo; \equiv rM^d\mod N$$</p>
<p>Multiplying both sides of the above equation with \(r^{-1}\mod N\)
$$S&rsquo;r^{-1}\equiv rM^dr^{-1}\mod N$$
$$S&rsquo;r^{-1}\equiv M^d\mod N$$
$$S\equiv S&rsquo;r^{-1}\mod N$$</p>
<p>So without actually getting the signature on \(M\), Marvin could successfully manipulate the signature \(S’\) to gain the signature of \(M\) i.e. \(S\). This technique allows an attacker to get signature on a message of his choice without the consent of the one who is signing it.</p>
<h2 id="preventing-blinding-attack">Preventing Blinding Attack<a hidden class="anchor" aria-hidden="true" href="#preventing-blinding-attack">#</a></h2>
<p>The question which arises now is, what could be the possible measures to prevent such attacks?</p>
<ol>
<li>
<p>If the signatory signs the Hash of the message \(M\) instead of signing the message itself, all the four steps in the attack would make no sense since \(M&rsquo;\) would then be replaced by H(M’) (The hash function) and hence it cannot be divided by blinding factor to get back \(M\).</p>
</li>
<li>
<p>Another advantage of using hash of the message instead of using the message is that a cryptographic hash can take an arbitrarily long message, and literally &lsquo;compress&rsquo; it into a short string, in such a way that we cannot find two messages that hash to the same value. Hence, signing the hash is just as good as signing the original message, without the length restrictions we would have if we didn’t use a hash. This overcomes the size problem in RSA operation where the key has to be very large in order to sign smaller messages!</p>
</li>
</ol>
<h2 id="references">References<a hidden class="anchor" aria-hidden="true" href="#references">#</a></h2>
<ol>
<li>Twenty years of Attacks on RSA: <a href="https://crypto.stanford.edu/~dabo/papers/RSA-survey.pdf">https://crypto.stanford.edu/~dabo/papers/RSA-survey.pdf</a></li>
</ol>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://ashutosh1206.github.io/tags/blinding-attack/">Blinding-Attack</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://ashutosh1206.github.io/">Ash&#39;s blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
