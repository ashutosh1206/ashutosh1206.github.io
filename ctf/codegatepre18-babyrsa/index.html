<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>BabyRSA - Codegate Preliminary CTF | Ash&#39;s blog</title>
<meta name="keywords" content="RSA, NumberTheory">
<meta name="description" content="Challenge Points: 349
The idea behind the challenge involved knowledge of basic Number Theory which was pretty cool!
We are given an encryption script and public key parameters that are used for encrypting a message. Everything in the script works normally except the GenerateKeys function:
def GenerateKeys(p, q): e = 65537 n = p * q pi_n = (p-1)*(q-1) d = mulinv(e, pi_n) h = (d&#43;p)^(d-p) g = d*(p-0xdeadbeef) return [e, n, h, g] There is are two extra variables other than the regular public key parameters whose values are known: g and h">
<meta name="author" content="Ashutosh Ahelleya">
<link rel="canonical" href="https://ashutosh1206.github.io/ctf/codegatepre18-babyrsa/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.bccfefac377bc340f06c260aed1bddf49a4354816d7c570d6aac75a997986c95.css" integrity="sha256-vM/vrDd7w0DwbCYK7Rvd9JpDVIFtfFcNaqx1qZeYbJU=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://ashutosh1206.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://ashutosh1206.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://ashutosh1206.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://ashutosh1206.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://ashutosh1206.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js" integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>
<meta property="og:title" content="BabyRSA - Codegate Preliminary CTF" />
<meta property="og:description" content="Challenge Points: 349
The idea behind the challenge involved knowledge of basic Number Theory which was pretty cool!
We are given an encryption script and public key parameters that are used for encrypting a message. Everything in the script works normally except the GenerateKeys function:
def GenerateKeys(p, q): e = 65537 n = p * q pi_n = (p-1)*(q-1) d = mulinv(e, pi_n) h = (d&#43;p)^(d-p) g = d*(p-0xdeadbeef) return [e, n, h, g] There is are two extra variables other than the regular public key parameters whose values are known: g and h" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ashutosh1206.github.io/ctf/codegatepre18-babyrsa/" /><meta property="article:section" content="ctf" />
<meta property="article:published_time" content="2018-03-01T00:00:00+00:00" />
<meta property="article:modified_time" content="2018-03-01T00:00:00+00:00" /><meta property="og:site_name" content="Ash&#39;s blog" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="BabyRSA - Codegate Preliminary CTF"/>
<meta name="twitter:description" content="Challenge Points: 349
The idea behind the challenge involved knowledge of basic Number Theory which was pretty cool!
We are given an encryption script and public key parameters that are used for encrypting a message. Everything in the script works normally except the GenerateKeys function:
def GenerateKeys(p, q): e = 65537 n = p * q pi_n = (p-1)*(q-1) d = mulinv(e, pi_n) h = (d&#43;p)^(d-p) g = d*(p-0xdeadbeef) return [e, n, h, g] There is are two extra variables other than the regular public key parameters whose values are known: g and h"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Ctfs",
      "item": "https://ashutosh1206.github.io/ctf/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "BabyRSA - Codegate Preliminary CTF",
      "item": "https://ashutosh1206.github.io/ctf/codegatepre18-babyrsa/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "BabyRSA - Codegate Preliminary CTF",
  "name": "BabyRSA - Codegate Preliminary CTF",
  "description": "Challenge Points: 349\nThe idea behind the challenge involved knowledge of basic Number Theory which was pretty cool!\nWe are given an encryption script and public key parameters that are used for encrypting a message. Everything in the script works normally except the GenerateKeys function:\ndef GenerateKeys(p, q): e = 65537 n = p * q pi_n = (p-1)*(q-1) d = mulinv(e, pi_n) h = (d+p)^(d-p) g = d*(p-0xdeadbeef) return [e, n, h, g] There is are two extra variables other than the regular public key parameters whose values are known: g and h",
  "keywords": [
    "RSA", "NumberTheory"
  ],
  "articleBody": "Challenge Points: 349\nThe idea behind the challenge involved knowledge of basic Number Theory which was pretty cool!\nWe are given an encryption script and public key parameters that are used for encrypting a message. Everything in the script works normally except the GenerateKeys function:\ndef GenerateKeys(p, q): e = 65537 n = p * q pi_n = (p-1)*(q-1) d = mulinv(e, pi_n) h = (d+p)^(d-p) g = d*(p-0xdeadbeef) return [e, n, h, g] There is are two extra variables other than the regular public key parameters whose values are known: g and h\nThere were two solutions to this challenge:\nBit by Bit Decryption Application of Number Theory Factorizing the modulus n \\(g = d*(p - 0xdeadbeef)\\)\nMultiplying both sides by e we have:\n\\(eg = ed(p-0xdeadbeef)\\)\n\\(eg \\equiv ed(p-0xdeadbeef)\\mod n\\)\nHence, we can write: (1) –\u003e $$2^{eg}\\equiv 2^{ed(p-0xdeadbeef)}\\mod n$$\nLet us try to simplify RHS: \\(2^{ed(p-0xdeadbeef)}\\mod n\\)\n\\(\\implies 2^{ed(p-0xdeadbeef)} \\equiv 2^{(1+k\\phi(n))(p-0xdeadbeef)}\\mod n\\)\n\\(\\implies 2^{ed(p-0xdeadbeef)} \\equiv 2^{(p-0xdeadbeef)}2^{k\\phi(n)(p-0xdeadbeef)} \\mod n\\)\nApplying Euler’s Theorem: \\(a^{\\phi(n)}\\equiv 1\\mod n\\), we have:\n\\(\\implies 2^{ed(p-0xdeadbeef)} \\equiv 2^{(p-0xdeadbeef)} \\mod n\\)\nUpon re-writing (1), we get:\n\\(2^{eg}\\equiv 2^{(p-0xdeadbeef)}\\mod n\\)\n\\(2^{eg}2^{0xdeadbeef}\\equiv 2^p\\mod n\\) –\u003e (2)\nFrom Fermat’s Little Theorem we have: if GCD(a, p) = 1, \\(a^{p}\\equiv a\\mod p\\) \\(\\implies a^p = k*p + a\\), \\(k\\in\\mathbb{I^+}\\)\n\\(\\implies 2^p = k*p + 2\\), \\(k\\in\\mathbb{I^+}\\)\nWe can simplify (2) as:\n\\(2^{eg+0xdeadbeef}\\equiv (k*p + 2)\\mod n\\)\n\\(2^{eg+0xdeadbeef} - 2\\equiv k*p\\mod n\\)\nThe above equation will result in a value that is a multiple of one of the prime factors of the modulus n - ie. p. We can now easily factor the modulus as:\n$$p = GCD(2^{eg+0xdeadbeef} - 2, n)$$ $$q = n/p$$\nIt’s very easy to find the flag, once we get the factors of n. Full solution:\nfrom Crypto.Util.number import * g = 14511485561279877242490049924164262671564856980418706493772866848857612385453104346586350276227873984815502106112389832011566814347565705873657427101510533972939335373118027470906354834216983842099812965592939768854241417529908124711818216182341332507918374220901579987851767888710421089266081280013256600425746557269742268670300714949183260246617797156425767983027415373581836147225552931559016487193903056680274018867169067069164417868649729813464306199388375773268972224468436723728788928618254041886532217172217283880677562744928063668302190530092708676086756514664006766909499651097644447881334032649057611965077951245778537347658519214651268439995915614667939336569800565797702566887133370244643122543689011224353239395653153094885449557256699923700742653930928887024447374907536229536501931493386170594869542262576409686250950887746501725676758035668270309685358291271363775138099327895323451901829587908987436831617628346535627562925010698445652286450107659802164994355539623617745529876829000553355956755914526849056343372137493951531663650121127924626353148067965144997177441402726593083629261964699315644045714647617156724816370270635144953182744245498998992807987174252376199074131496163299914588620694929584594866873400406185502626180264465104468365933575409921644759774899908018217623256295871823903858740112075223018089096313796599554636163186830200265892525403238639070366999401808068998639590975305617369688731214141047568939908240058088089504343104889824160334560324387496383256518400827927341943755279126157377196722373876343583757261084975726106468397487366825775319965557539853162973895788663508023419482720093445137085452233528426725965549266605359644884153719762909553953900709890192728260024241748671796401590112629479273363064208874240854298225057415248756216847693518038319188675206377870041466557414694779134628404260587970 N = 523639805914061918270627443134741619704989339108811345591765650823383811679404400743730300288077320843234806116907796484315512386749183735427076044515394957782722144465236043561036957495670530886847413432636828661793513741180618385135095922719611444315861194066682307139969523206842728092440966461922557111209480112023032164065707216752568624317883094770784553451376502893748762652573604180632157059219119741129827017117558208565054860250853978397405747507844727903363351081745897472675235414693294079400158465019978970101063161094836772073302365997371679643083941089269169502839517043186914783290465318781726781533226599462066259256698885200843104424722505593942510854302401488139137362276492532699951880474157691347473741517183512613811731637427562990396497067805682564174185792379491573312640862381843195615293946630128509982267460922475624107750277459002662884836031305873522960659017891138316482378312004790485681371129328860344989214941450460756203906709954285455206483931555441550631622907560476932030275168094874500348941952385811045752980245084909805234648503736291123092594689494187215718382724496356220857628352007757197464098872772987476828030721472777531411032286344430474215475330008833588291692767417022829531866323051 encrypted_data = 380838525806255337893946743050327173947433371586247814759050430578204300094635270877953690129762202769875996939276197842147224857220372679703619497806927398399795108952962442891905146440202908075035070979097412854358636621348531277713225298087614167276769631514565642627640343771883615641654535423058064397195504442204533423747451626752470200734177912209703945585196661670059908372263823148356525332391696830864610833871912286943309315368473809329884078356658600058695228563250424729883958206468130236010169302227516477051342268478958591705205358855157076547042386496593253499052139707216013118968009859098636706611794339780312391554420587540660796607687910531233690474314728367495027785278881971814489961127141923005420385579115964806930701533734013794866357390109761177291603859980361697959155126598284421792362843501361967548503757576918138895493498276658301936707818035503138088925361983300854592909022681075014994189523262500924039153521343614460622246152945716505290603455309333333560506091410274263241508522602811994582040578653226240563907254131889033343189265841619698442130035569880428826546382882121430886993470180883869383405219173399698928360778092640513571913940390199302310817294277155376000921294944591121246587133744 e = 65537 # Using Euler's Theorem and Fermat's Little Theorem we have t1 = pow(2, e*g, N) t2 = pow(2, 0xdeadbeef, N) p = GCD((t1*t2)-2,N) assert N % p == 0 q = N / p phin = (p-1)*(q-1) d = inverse(e, phin) m = pow(encrypted_data, d, N) print long_to_bytes(m) Running the above script gives us the flag: Whatever you do, the Basics are the most important :D\n",
  "wordCount" : "370",
  "inLanguage": "en",
  "datePublished": "2018-03-01T00:00:00Z",
  "dateModified": "2018-03-01T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Ashutosh Ahelleya"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://ashutosh1206.github.io/ctf/codegatepre18-babyrsa/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Ash's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://ashutosh1206.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://ashutosh1206.github.io/" accesskey="h" title="Home (Alt + H)">Home</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://ashutosh1206.github.io/blog/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://ashutosh1206.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://ashutosh1206.github.io/archive/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://ashutosh1206.github.io/ctf/" title="CTF">
                    <span>CTF</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      BabyRSA - Codegate Preliminary CTF
    </h1>
    <div class="post-meta"><span title='2018-03-01 00:00:00 +0000 UTC'>March 1, 2018</span>&nbsp;·&nbsp;Ashutosh Ahelleya

</div>
  </header> 
  <div class="post-content"><p><strong>Challenge Points</strong>: 349</p>
<p>The idea behind the challenge involved knowledge of basic Number Theory which was pretty cool!</p>
<p>We are given <a href="">an encryption script</a> and public key parameters that are used for encrypting a message. Everything in the script works normally except the <code>GenerateKeys</code> function:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">GenerateKeys</span>(p, q):
</span></span><span style="display:flex;"><span>    e <span style="color:#f92672">=</span> <span style="color:#ae81ff">65537</span>
</span></span><span style="display:flex;"><span>    n <span style="color:#f92672">=</span> p <span style="color:#f92672">*</span> q
</span></span><span style="display:flex;"><span>    pi_n <span style="color:#f92672">=</span> (p<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>(q<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    d <span style="color:#f92672">=</span> mulinv(e, pi_n)
</span></span><span style="display:flex;"><span>    h <span style="color:#f92672">=</span> (d<span style="color:#f92672">+</span>p)<span style="color:#f92672">^</span>(d<span style="color:#f92672">-</span>p)
</span></span><span style="display:flex;"><span>    g <span style="color:#f92672">=</span> d<span style="color:#f92672">*</span>(p<span style="color:#f92672">-</span><span style="color:#ae81ff">0xdeadbeef</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> [e, n, h, g]
</span></span></code></pre></div><p>There is are two extra variables other than the regular public key parameters whose values are known: <code>g</code> and <code>h</code></p>
<p>There were two solutions to this challenge:</p>
<ol>
<li><a href="https://gist.github.com/hellman/0fd746dfe80c2ce8e75248b337cbd7a5#file-4_solve-py">Bit by Bit Decryption</a></li>
<li>Application of Number Theory</li>
</ol>
<h2 id="factorizing-the-modulus-n">Factorizing the modulus <code>n</code><a hidden class="anchor" aria-hidden="true" href="#factorizing-the-modulus-n">#</a></h2>
<p>\(g = d*(p - 0xdeadbeef)\)<br>
Multiplying both sides by <code>e</code> we have:<br>
\(eg = ed(p-0xdeadbeef)\)<br>
\(eg \equiv ed(p-0xdeadbeef)\mod n\)</p>
<p>Hence, we can write:
<strong>(1)</strong> &ndash;&gt; $$2^{eg}\equiv 2^{ed(p-0xdeadbeef)}\mod n$$</p>
<p>Let us try to simplify RHS:
\(2^{ed(p-0xdeadbeef)}\mod n\)<br>
\(\implies 2^{ed(p-0xdeadbeef)} \equiv 2^{(1+k\phi(n))(p-0xdeadbeef)}\mod n\)<br>
\(\implies 2^{ed(p-0xdeadbeef)} \equiv 2^{(p-0xdeadbeef)}2^{k\phi(n)(p-0xdeadbeef)} \mod n\)<br>
Applying <a href="https://en.wikipedia.org/wiki/Euler%27s_theorem">Euler&rsquo;s Theorem</a>: \(a^{\phi(n)}\equiv 1\mod n\), we have:<br>
\(\implies 2^{ed(p-0xdeadbeef)} \equiv 2^{(p-0xdeadbeef)} \mod n\)</p>
<p>Upon re-writing <strong>(1)</strong>, we get:<br>
\(2^{eg}\equiv 2^{(p-0xdeadbeef)}\mod n\)<br>
\(2^{eg}2^{0xdeadbeef}\equiv 2^p\mod n\) &ndash;&gt; <strong>(2)</strong></p>
<p>From <a href="https://en.wikipedia.org/wiki/Fermat%27s_little_theorem">Fermat&rsquo;s Little Theorem</a> we have: if GCD(a, p) = 1, \(a^{p}\equiv a\mod p\)   <br>
\(\implies a^p = k*p + a\), \(k\in\mathbb{I^+}\)<br>
\(\implies 2^p = k*p + 2\), \(k\in\mathbb{I^+}\)</p>
<p>We can simplify <strong>(2)</strong> as:<br>
\(2^{eg+0xdeadbeef}\equiv (k*p + 2)\mod n\)<br>
\(2^{eg+0xdeadbeef} - 2\equiv k*p\mod n\)</p>
<p>The above equation will result in a value that is a multiple of one of the prime factors of the modulus <code>n</code> - ie. <code>p</code>. We can now easily factor the modulus as:<br>
$$p = GCD(2^{eg+0xdeadbeef} - 2, n)$$
$$q = n/p$$</p>
<p>It&rsquo;s very easy to find the flag, once we get the factors of <code>n</code>. Full solution:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>g <span style="color:#f92672">=</span>  <span style="color:#ae81ff">14511485561279877242490049924164262671564856980418706493772866848857612385453104346586350276227873984815502106112389832011566814347565705873657427101510533972939335373118027470906354834216983842099812965592939768854241417529908124711818216182341332507918374220901579987851767888710421089266081280013256600425746557269742268670300714949183260246617797156425767983027415373581836147225552931559016487193903056680274018867169067069164417868649729813464306199388375773268972224468436723728788928618254041886532217172217283880677562744928063668302190530092708676086756514664006766909499651097644447881334032649057611965077951245778537347658519214651268439995915614667939336569800565797702566887133370244643122543689011224353239395653153094885449557256699923700742653930928887024447374907536229536501931493386170594869542262576409686250950887746501725676758035668270309685358291271363775138099327895323451901829587908987436831617628346535627562925010698445652286450107659802164994355539623617745529876829000553355956755914526849056343372137493951531663650121127924626353148067965144997177441402726593083629261964699315644045714647617156724816370270635144953182744245498998992807987174252376199074131496163299914588620694929584594866873400406185502626180264465104468365933575409921644759774899908018217623256295871823903858740112075223018089096313796599554636163186830200265892525403238639070366999401808068998639590975305617369688731214141047568939908240058088089504343104889824160334560324387496383256518400827927341943755279126157377196722373876343583757261084975726106468397487366825775319965557539853162973895788663508023419482720093445137085452233528426725965549266605359644884153719762909553953900709890192728260024241748671796401590112629479273363064208874240854298225057415248756216847693518038319188675206377870041466557414694779134628404260587970</span>
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> <span style="color:#ae81ff">523639805914061918270627443134741619704989339108811345591765650823383811679404400743730300288077320843234806116907796484315512386749183735427076044515394957782722144465236043561036957495670530886847413432636828661793513741180618385135095922719611444315861194066682307139969523206842728092440966461922557111209480112023032164065707216752568624317883094770784553451376502893748762652573604180632157059219119741129827017117558208565054860250853978397405747507844727903363351081745897472675235414693294079400158465019978970101063161094836772073302365997371679643083941089269169502839517043186914783290465318781726781533226599462066259256698885200843104424722505593942510854302401488139137362276492532699951880474157691347473741517183512613811731637427562990396497067805682564174185792379491573312640862381843195615293946630128509982267460922475624107750277459002662884836031305873522960659017891138316482378312004790485681371129328860344989214941450460756203906709954285455206483931555441550631622907560476932030275168094874500348941952385811045752980245084909805234648503736291123092594689494187215718382724496356220857628352007757197464098872772987476828030721472777531411032286344430474215475330008833588291692767417022829531866323051</span>
</span></span><span style="display:flex;"><span>encrypted_data <span style="color:#f92672">=</span> <span style="color:#ae81ff">380838525806255337893946743050327173947433371586247814759050430578204300094635270877953690129762202769875996939276197842147224857220372679703619497806927398399795108952962442891905146440202908075035070979097412854358636621348531277713225298087614167276769631514565642627640343771883615641654535423058064397195504442204533423747451626752470200734177912209703945585196661670059908372263823148356525332391696830864610833871912286943309315368473809329884078356658600058695228563250424729883958206468130236010169302227516477051342268478958591705205358855157076547042386496593253499052139707216013118968009859098636706611794339780312391554420587540660796607687910531233690474314728367495027785278881971814489961127141923005420385579115964806930701533734013794866357390109761177291603859980361697959155126598284421792362843501361967548503757576918138895493498276658301936707818035503138088925361983300854592909022681075014994189523262500924039153521343614460622246152945716505290603455309333333560506091410274263241508522602811994582040578653226240563907254131889033343189265841619698442130035569880428826546382882121430886993470180883869383405219173399698928360778092640513571913940390199302310817294277155376000921294944591121246587133744</span>
</span></span><span style="display:flex;"><span>e <span style="color:#f92672">=</span> <span style="color:#ae81ff">65537</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Using Euler&#39;s Theorem and Fermat&#39;s Little Theorem we have</span>
</span></span><span style="display:flex;"><span>t1 <span style="color:#f92672">=</span> pow(<span style="color:#ae81ff">2</span>, e<span style="color:#f92672">*</span>g, N)
</span></span><span style="display:flex;"><span>t2 <span style="color:#f92672">=</span> pow(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0xdeadbeef</span>, N)
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> GCD((t1<span style="color:#f92672">*</span>t2)<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>,N)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">assert</span> N <span style="color:#f92672">%</span> p <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> N <span style="color:#f92672">/</span> p
</span></span><span style="display:flex;"><span>phin <span style="color:#f92672">=</span> (p<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>(q<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>d <span style="color:#f92672">=</span> inverse(e, phin)
</span></span><span style="display:flex;"><span>m <span style="color:#f92672">=</span> pow(encrypted_data, d, N)
</span></span><span style="display:flex;"><span>print long_to_bytes(m)
</span></span></code></pre></div><p>Running the above script gives us the <strong>flag</strong>: Whatever you do, the Basics are the most important :D</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://ashutosh1206.github.io/tags/rsa/">RSA</a></li>
      <li><a href="https://ashutosh1206.github.io/tags/numbertheory/">NumberTheory</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://ashutosh1206.github.io/">Ash&#39;s blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
