<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Daring - Hxp CTF | Ashutosh Ahelleya</title><meta name=keywords content="RSA,NumberTheory"><meta name=description content="Challenge Points:
Challenge Description:
We encrypted our flag, but we lost the keys. Can you help?
This was a simple yet a very tricky challenge aimed at testing Number Theory basics. In this challenge we are given a small script:
#!/usr/bin/env python3 import os from Crypto.Cipher import AES from Crypto.Hash import SHA256 from Crypto.Util import Counter from Crypto.PublicKey import RSA flag = open('flag.txt', 'rb').read().strip() key = RSA.generate(1024, e=3) open('pubkey.txt', 'w').write(key.publickey().exportKey('PEM').decode() + '\n') open('rsa."><meta name=author content="Ashutosh Ahelleya"><link rel=canonical href=https://ashutosh1206.github.io/ctf/hxp18-daring/><link crossorigin=anonymous href=/assets/css/stylesheet.bccfefac377bc340f06c260aed1bddf49a4354816d7c570d6aac75a997986c95.css integrity="sha256-vM/vrDd7w0DwbCYK7Rvd9JpDVIFtfFcNaqx1qZeYbJU=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://ashutosh1206.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ashutosh1206.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ashutosh1206.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://ashutosh1206.github.io/apple-touch-icon.png><link rel=mask-icon href=https://ashutosh1206.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css integrity=sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0 crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js integrity=sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4 crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous onload=renderMathInElement(document.body)></script><meta property="og:title" content="Daring - Hxp CTF"><meta property="og:description" content="Challenge Points:
Challenge Description:
We encrypted our flag, but we lost the keys. Can you help?
This was a simple yet a very tricky challenge aimed at testing Number Theory basics. In this challenge we are given a small script:
#!/usr/bin/env python3 import os from Crypto.Cipher import AES from Crypto.Hash import SHA256 from Crypto.Util import Counter from Crypto.PublicKey import RSA flag = open('flag.txt', 'rb').read().strip() key = RSA.generate(1024, e=3) open('pubkey.txt', 'w').write(key.publickey().exportKey('PEM').decode() + '\n') open('rsa."><meta property="og:type" content="article"><meta property="og:url" content="https://ashutosh1206.github.io/ctf/hxp18-daring/"><meta property="article:section" content="ctf"><meta property="article:published_time" content="2018-12-09T00:00:00+00:00"><meta property="article:modified_time" content="2018-12-09T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Daring - Hxp CTF"><meta name=twitter:description content="Challenge Points:
Challenge Description:
We encrypted our flag, but we lost the keys. Can you help?
This was a simple yet a very tricky challenge aimed at testing Number Theory basics. In this challenge we are given a small script:
#!/usr/bin/env python3 import os from Crypto.Cipher import AES from Crypto.Hash import SHA256 from Crypto.Util import Counter from Crypto.PublicKey import RSA flag = open('flag.txt', 'rb').read().strip() key = RSA.generate(1024, e=3) open('pubkey.txt', 'w').write(key.publickey().exportKey('PEM').decode() + '\n') open('rsa."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Ctfs","item":"https://ashutosh1206.github.io/ctf/"},{"@type":"ListItem","position":2,"name":"Daring - Hxp CTF","item":"https://ashutosh1206.github.io/ctf/hxp18-daring/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Daring - Hxp CTF","name":"Daring - Hxp CTF","description":"Challenge Points:\nChallenge Description:\nWe encrypted our flag, but we lost the keys. Can you help?\nThis was a simple yet a very tricky challenge aimed at testing Number Theory basics. In this challenge we are given a small script:\n#!/usr/bin/env python3 import os from Crypto.Cipher import AES from Crypto.Hash import SHA256 from Crypto.Util import Counter from Crypto.PublicKey import RSA flag = open(\u0026#39;flag.txt\u0026#39;, \u0026#39;rb\u0026#39;).read().strip() key = RSA.generate(1024, e=3) open(\u0026#39;pubkey.txt\u0026#39;, \u0026#39;w\u0026#39;).write(key.publickey().exportKey(\u0026#39;PEM\u0026#39;).decode() + \u0026#39;\\n\u0026#39;) open(\u0026#39;rsa.","keywords":["RSA","NumberTheory"],"articleBody":"Challenge Points:\nChallenge Description:\nWe encrypted our flag, but we lost the keys. Can you help?\nThis was a simple yet a very tricky challenge aimed at testing Number Theory basics. In this challenge we are given a small script:\n#!/usr/bin/env python3 import os from Crypto.Cipher import AES from Crypto.Hash import SHA256 from Crypto.Util import Counter from Crypto.PublicKey import RSA flag = open('flag.txt', 'rb').read().strip() key = RSA.generate(1024, e=3) open('pubkey.txt', 'w').write(key.publickey().exportKey('PEM').decode() + '\\n') open('rsa.enc', 'wb').write(pow(int.from_bytes(flag.ljust(128, b'\\0'), 'big'), key.e, key.n).to_bytes(128, 'big')) key = SHA256.new(key.exportKey('DER')).digest() open('aes.enc', 'wb').write(AES.new(key, AES.MODE_CTR, counter=Counter.new(128)).encrypt(flag)) If we analyse the script carefully, we would notice that the same flag is encrypted in two different, independent ways:\nThe flag is padded with \\x00 (null byte) to make the plaintext of size 128 bytes and then encrypted using RSA with public key exponent e = 3 SHA-256 hash of the RSA private key is calculated, the result of which is then used as a symmetric key to encrypt the unpadded flag using AES in CTR mode. Some observations:\nWe all know that e = 3 is vulnerable to root attack, but here in our challenge, since the flag is padded with null bytes to increase its size to 128 bytes, the root attack won’t work since \\(pt^3 \u003e n\\) and hence will wrap around while calculating the ciphertext pt is the padded plaintext and n is the RSA modulus When some plaintext is encrypted in CTR mode, remember that the ciphertext size is exactly of the same size as plaintext, since CTR mode is similar to a stream cipher. Based on the second observation, we can say that since length of ciphertext of AES-encrypted flag is 43 bytes, the original size of the flag is 43 bytes.\npt = flag + ‘\\x00’*(128-43) = flag + ‘\\x00’*85\n\\(ct \\equiv (flag*2^{85*8})^3 \\mod n\\)\n\\(ct \\equiv flag^3*2^{680*3} \\mod n\\)\nTo compute \\(flag^3\\mod n\\) we can compute: $$ct*(2^{-1}\\mod n)^{680*3}\\mod n$$ $$\\equiv flag^3*2^{680*3}*2^{-680*3}\\mod n$$ $$\\equiv flag^3\\mod n$$\nProbably flag3 \u003e n, since flag is of 43 bytes. Then we can write:\n\\(x = flag^3 % n\\)\n\\(flag^3 = x + k*n\\)\nNow if we add multiples of n to x and check if the resultant value is a perfect cube, we can get the flag by taking the cube root. This part of the challenge is similar to Iowe challenge from CSAW CTF Qualifiers 2018: https://ctftime.org/task/6668\nI wrote the following script to get the flag:\n#!/usr/bin/env python3 import os from Crypto.Cipher import AES from Crypto.Hash import SHA256 from Crypto.Util import Counter from Crypto.Util.number import * from Crypto.PublicKey import RSA import gmpy2 pubkey = RSA.importKey(open(\"pubkey.txt\").read()) e = pubkey.e n = pubkey.n rsa_enc = int.from_bytes(open(\"rsa.enc\",\"rb\").read(), 'big') assert GCD(2, n) == 1 # 680 * 3 = 2040 inv = pow(inverse(2, n), 2040, n) aes_enc = open(\"aes.enc\",\"rb\").read() # From here we get the size of the actual flag assert len(aes_enc) == 43 print(int.from_bytes(b\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\".ljust(128,b'\\0'), 'big') == int.from_bytes(b\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\", 'big') \u003c\u003c 680) rsa_enc = rsa_enc*inv % n for i in range(1000): ans = gmpy2.iroot(rsa_enc + i*n, 3)[1] if ans == True: print(\"Gotit\", i) pt = int(gmpy2.iroot(rsa_enc + i*n, 3)[0]) print(pt.to_bytes(43, 'big')) break You can find all the relevant files here!\n","wordCount":"517","inLanguage":"en","datePublished":"2018-12-09T00:00:00Z","dateModified":"2018-12-09T00:00:00Z","author":{"@type":"Person","name":"Ashutosh Ahelleya"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ashutosh1206.github.io/ctf/hxp18-daring/"},"publisher":{"@type":"Organization","name":"Ashutosh Ahelleya","logo":{"@type":"ImageObject","url":"https://ashutosh1206.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ashutosh1206.github.io/ accesskey=h title="Home (Alt + H)">Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ashutosh1206.github.io/blog/ title=Blog><span>Blog</span></a></li><li><a href=https://ashutosh1206.github.io/archive/ title=Archive><span>Archive</span></a></li><li><a href=https://ashutosh1206.github.io/ctf/ title=CTF><span>CTF</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Daring - Hxp CTF</h1><div class=post-meta><span title='2018-12-09 00:00:00 +0000 UTC'>December 9, 2018</span>&nbsp;·&nbsp;Ashutosh Ahelleya</div></header><div class=post-content><p><strong>Challenge Points</strong>:<br><strong>Challenge Description</strong>:</p><blockquote><p>We encrypted our flag, but we lost the keys. Can you help?</p></blockquote><p>This was a simple yet a very tricky challenge aimed at testing Number Theory basics. In this challenge we are given a small script:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env python3</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Cipher <span style=color:#f92672>import</span> AES
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Hash <span style=color:#f92672>import</span> SHA256
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util <span style=color:#f92672>import</span> Counter
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.PublicKey <span style=color:#f92672>import</span> RSA
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#39;flag.txt&#39;</span>, <span style=color:#e6db74>&#39;rb&#39;</span>)<span style=color:#f92672>.</span>read()<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>key <span style=color:#f92672>=</span> RSA<span style=color:#f92672>.</span>generate(<span style=color:#ae81ff>1024</span>, e<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>open(<span style=color:#e6db74>&#39;pubkey.txt&#39;</span>, <span style=color:#e6db74>&#39;w&#39;</span>)<span style=color:#f92672>.</span>write(key<span style=color:#f92672>.</span>publickey()<span style=color:#f92672>.</span>exportKey(<span style=color:#e6db74>&#39;PEM&#39;</span>)<span style=color:#f92672>.</span>decode() <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>open(<span style=color:#e6db74>&#39;rsa.enc&#39;</span>, <span style=color:#e6db74>&#39;wb&#39;</span>)<span style=color:#f92672>.</span>write(pow(int<span style=color:#f92672>.</span>from_bytes(flag<span style=color:#f92672>.</span>ljust(<span style=color:#ae81ff>128</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\0</span><span style=color:#e6db74>&#39;</span>), <span style=color:#e6db74>&#39;big&#39;</span>), key<span style=color:#f92672>.</span>e, key<span style=color:#f92672>.</span>n)<span style=color:#f92672>.</span>to_bytes(<span style=color:#ae81ff>128</span>, <span style=color:#e6db74>&#39;big&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>key <span style=color:#f92672>=</span> SHA256<span style=color:#f92672>.</span>new(key<span style=color:#f92672>.</span>exportKey(<span style=color:#e6db74>&#39;DER&#39;</span>))<span style=color:#f92672>.</span>digest()
</span></span><span style=display:flex><span>open(<span style=color:#e6db74>&#39;aes.enc&#39;</span>, <span style=color:#e6db74>&#39;wb&#39;</span>)<span style=color:#f92672>.</span>write(AES<span style=color:#f92672>.</span>new(key, AES<span style=color:#f92672>.</span>MODE_CTR, counter<span style=color:#f92672>=</span>Counter<span style=color:#f92672>.</span>new(<span style=color:#ae81ff>128</span>))<span style=color:#f92672>.</span>encrypt(flag))
</span></span></code></pre></div><p>If we analyse the script carefully, we would notice that the same flag is encrypted in two different, independent ways:</p><ol><li>The flag is padded with <code>\x00</code> (null byte) to make the plaintext of size 128 bytes and then encrypted using RSA with public key exponent <code>e</code> = 3</li><li>SHA-256 hash of the RSA private key is calculated, the result of which is then used as a symmetric key to encrypt the unpadded flag using AES in CTR mode.</li></ol><p>Some <strong>observations</strong>:</p><ol><li>We all know that <code>e = 3</code> is vulnerable to root attack, but here in our challenge, since the flag is padded with null bytes to increase its size to 128 bytes, the root attack won&rsquo;t work since \(pt^3 > n\) and hence will wrap around while calculating the ciphertext<ul><li><code>pt</code> is the padded plaintext and <code>n</code> is the RSA modulus</li></ul></li><li>When some plaintext is encrypted in CTR mode, remember that the ciphertext size is exactly of the same size as plaintext, since CTR mode is similar to a stream cipher.</li></ol><p>Based on the second observation, we can say that since length of ciphertext of AES-encrypted flag is 43 bytes, the original size of the flag is 43 bytes.<br>pt = flag + &lsquo;\x00&rsquo;*(128-43) = flag + &lsquo;\x00&rsquo;*85</p><p>\(ct \equiv (flag*2^{85*8})^3 \mod n\)<br>\(ct \equiv flag^3*2^{680*3} \mod n\)</p><p>To compute \(flag^3\mod n\) we can compute:
$$ct*(2^{-1}\mod n)^{680*3}\mod n$$
$$\equiv flag^3*2^{680*3}*2^{-680*3}\mod n$$
$$\equiv flag^3\mod n$$</p><p>Probably flag3 > n, since flag is of 43 bytes. Then we can write:<br>\(x = flag^3 % n\)<br>\(flag^3 = x + k*n\)</p><p>Now if we add multiples of <code>n</code> to <code>x</code> and check if the resultant value is a perfect cube, we can get the flag by taking the cube root. This part of the challenge is similar to Iowe challenge from CSAW CTF Qualifiers 2018: <a href=https://ctftime.org/task/6668>https://ctftime.org/task/6668</a></p><p>I wrote the following script to get the flag:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env python3</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Cipher <span style=color:#f92672>import</span> AES
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Hash <span style=color:#f92672>import</span> SHA256
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util <span style=color:#f92672>import</span> Counter
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.PublicKey <span style=color:#f92672>import</span> RSA
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> gmpy2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pubkey <span style=color:#f92672>=</span> RSA<span style=color:#f92672>.</span>importKey(open(<span style=color:#e6db74>&#34;pubkey.txt&#34;</span>)<span style=color:#f92672>.</span>read())
</span></span><span style=display:flex><span>e <span style=color:#f92672>=</span> pubkey<span style=color:#f92672>.</span>e
</span></span><span style=display:flex><span>n <span style=color:#f92672>=</span> pubkey<span style=color:#f92672>.</span>n
</span></span><span style=display:flex><span>rsa_enc <span style=color:#f92672>=</span> int<span style=color:#f92672>.</span>from_bytes(open(<span style=color:#e6db74>&#34;rsa.enc&#34;</span>,<span style=color:#e6db74>&#34;rb&#34;</span>)<span style=color:#f92672>.</span>read(), <span style=color:#e6db74>&#39;big&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>assert</span> GCD(<span style=color:#ae81ff>2</span>, n) <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 680 * 3 = 2040</span>
</span></span><span style=display:flex><span>inv <span style=color:#f92672>=</span> pow(inverse(<span style=color:#ae81ff>2</span>, n), <span style=color:#ae81ff>2040</span>, n)
</span></span><span style=display:flex><span>aes_enc <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#34;aes.enc&#34;</span>,<span style=color:#e6db74>&#34;rb&#34;</span>)<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># From here we get the size of the actual flag</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>assert</span> len(aes_enc) <span style=color:#f92672>==</span> <span style=color:#ae81ff>43</span>
</span></span><span style=display:flex><span>print(int<span style=color:#f92672>.</span>from_bytes(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#34;</span><span style=color:#f92672>.</span>ljust(<span style=color:#ae81ff>128</span>,<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\0</span><span style=color:#e6db74>&#39;</span>), <span style=color:#e6db74>&#39;big&#39;</span>) <span style=color:#f92672>==</span> int<span style=color:#f92672>.</span>from_bytes(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#34;</span>, <span style=color:#e6db74>&#39;big&#39;</span>) <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>680</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rsa_enc <span style=color:#f92672>=</span> rsa_enc<span style=color:#f92672>*</span>inv <span style=color:#f92672>%</span> n
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1000</span>):
</span></span><span style=display:flex><span>    ans <span style=color:#f92672>=</span> gmpy2<span style=color:#f92672>.</span>iroot(rsa_enc <span style=color:#f92672>+</span> i<span style=color:#f92672>*</span>n, <span style=color:#ae81ff>3</span>)[<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ans <span style=color:#f92672>==</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Gotit&#34;</span>, i)
</span></span><span style=display:flex><span>        pt <span style=color:#f92672>=</span> int(gmpy2<span style=color:#f92672>.</span>iroot(rsa_enc <span style=color:#f92672>+</span> i<span style=color:#f92672>*</span>n, <span style=color:#ae81ff>3</span>)[<span style=color:#ae81ff>0</span>])
</span></span><span style=display:flex><span>        print(pt<span style=color:#f92672>.</span>to_bytes(<span style=color:#ae81ff>43</span>, <span style=color:#e6db74>&#39;big&#39;</span>))
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>
</span></span></code></pre></div><p>You can find all the relevant files <a href=https://github.com/ashutosh1206/Crypto-CTF-Writeups/tree/master/2018/hxp-CTF/daring>here</a>!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://ashutosh1206.github.io/tags/rsa/>RSA</a></li><li><a href=https://ashutosh1206.github.io/tags/numbertheory/>NumberTheory</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://ashutosh1206.github.io/>Ashutosh Ahelleya</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>